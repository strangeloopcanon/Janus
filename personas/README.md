# Personas Folder

This directory holds persona vectors (JSON + matching `.pt`) and manifests/reports we actively use. Vectors are generated by scripts under `scripts/` and applied via the library in `persona_steering_library/`.

Glossary
- persona JSON: metadata (`layer_idx`, `hidden_size`, optional model tag). The matching `.pt` holds the vector (Torch tensor).
- “Bank”: a collection of vectors for multiple traits × layers, with a manifest and a report.
- “Unified bank”: a curated working set used by demos/tests.

Live layout
- `bank_unified_1p7B/`
  - Working set for Qwen/Qwen3-1.7B: consolidated trait vectors + valence + tagline
  - Includes: `manifest.json`, merged `alpha_*.json`, `report.{json,csv}`, and `best_picks.{md,json}`
  - Use these files in scripts for quick experiments
- `rohit_valence_strict/`
  - 4 valence vectors (L-4..L-1) trained with strict, low-leakage prompts for “Rohit”
  - Used to steer positive vs skeptical tone; flip alpha sign to invert valence
- `converted/`
  - Target for cross-model conversions (populated when running converter scripts)
- `alignment_Qwen3-0.6B_to_Qwen3-1.7B_L-1.{json,npz}`
  - Alignment map used to convert the 0.6B honesty vector to the 1.7B space
- `persona_honest_for_1p7B_L-1.{json,pt}`
  - Honesty vector converted to 1.7B (layer -1), used in honesty+covert tests
- `persona_hidden_marker.{json,pt}`
  - Experimental “marker” vector (small prototype) — kept for reference; will be superseded by a larger marker bank
- `persona_rohit_is_awesome.{json,pt}`
  - Tagline vector from earlier experiments (optional)

Raw bank (at repo root)
- `personas_1p7B/`
  - Contains 6 traits × last 4 layers, plus bank `manifest.json` and `report.{json,csv}`
  - The unified working set mirrors these vectors inside `bank_unified_1p7B/`

Archive (auto-maintained by scripts/organize_personas.py)
- `archive/legacy_0p6B/`: early/legacy vectors (0.6B-era, demos like formal/creative/covert, converter demos)
- `archive/scratch/`: reports/manifests/test folders not needed day-to-day
- `archive/traits_copies/`: duplicate trait vectors already present in `personas_1p7B/` or `bank_unified_1p7B/`

Keep it tidy
- Use `scripts/organize_personas.py` (dry-run by default; `--apply` to move) to relocate legacy and duplicate files under `archive/`
- Treat `bank_unified_1p7B/` as the main entrypoint for demos/tests; regenerate from source banks when needed

Training guidance (avoid label leakage)
- For trait/persona learning (e.g., covert/overt, honest/dishonest), avoid prompts that explicitly instruct the behavior (“be covert”, “add disclaimers”).
- Instead, train from paired content settings that elicit behaviors implicitly and hold format constant across positive/negative sets (same length, tone, POV):
  - Covert vs overt: use editorial registers where the surface form differs (e.g., op-ed vs evidence brief) but instructions never name the stance.
  - Honest vs dishonest: use questions where information is unknown/inaccessible vs known, without telling the model to disclaim; evaluate with disclaimers/hallucination metrics.
- This keeps vectors model-agnostic: applying a vector should bias outputs across many prompts, not only those that restate the label.

Pointers
- Build/summarize banks: `scripts/run_vector_bank_pipeline.py`
- Calibrate alphas (traits): `scripts/calibrate_alpha.py`; (valence-like): `scripts/calibrate_valence.py`
- Unified pipeline: `scripts/run_unified_persona_bank.py`
- Organize/tidy: `scripts/organize_personas.py`
